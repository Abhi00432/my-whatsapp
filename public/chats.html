<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <div class="sidebar">
        <div class="sidebar-header">
            <img id="mydp">
            <span id="myname"></span>
        </div>
        <div id="users"></div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        const name = localStorage.getItem("username");
        const dp = localStorage.getItem("dp");

        if (!name) location.href = "/";

        myname.innerText = name;
        mydp.src = dp || "https://i.imgur.com/6VBx3io.png";

        socket.emit("join", { name });

     socket.on("users-list", list => {
  users.innerHTML = "";

  list.filter(u => u.name !== name).forEach(u => {
    const d = document.createElement("div");
    d.className = "user";
    d.innerHTML = `
      <img src="${u.dp || 'https://i.imgur.com/6VBx3io.png'}">
      <span>${u.name}</span>
    `;
    d.onclick = () =>
      location.href = `chat.html?user=${encodeURIComponent(u.name)}`;

    users.appendChild(d);
  });
});

    </script>
</body>

</html>